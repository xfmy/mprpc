\doxysection{tinyrpc\+Network.\+h}
\hypertarget{tinyrpc_network_8h_source}{}\label{tinyrpc_network_8h_source}\index{include/tinyrpcNetwork.h@{include/tinyrpcNetwork.h}}
\mbox{\hyperlink{tinyrpc_network_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ }
\DoxyCodeLine{00011\ \textcolor{preprocessor}{\#pragma\ once}}
\DoxyCodeLine{00012\ \textcolor{preprocessor}{\#include\ <muduo/net/TcpServer.h>}}
\DoxyCodeLine{00013\ \textcolor{preprocessor}{\#include\ <muduo/net/EventLoop.h>}}
\DoxyCodeLine{00014\ \textcolor{preprocessor}{\#include\ <muduo/net/InetAddress.h>}}
\DoxyCodeLine{00015\ \textcolor{preprocessor}{\#include\ <memory>}}
\DoxyCodeLine{00016\ \textcolor{preprocessor}{\#include\ <string\_view>}}
\DoxyCodeLine{00017\ \textcolor{keyword}{using\ namespace\ }muduo;}
\DoxyCodeLine{00018\ \textcolor{keyword}{using\ namespace\ }muduo::net;}
\DoxyCodeLine{00019\ }
\DoxyCodeLine{00020\ \textcolor{keyword}{typedef}\ std::function<void(EventLoop\ *)>\ ThreadInitCallback;}
\DoxyCodeLine{00021\ \textcolor{keyword}{using\ }businessCallback\ =\ std::function<void(\textcolor{keyword}{const}\ TcpConnectionPtr\ \&,\ \textcolor{keyword}{const}\ std::string\ \&,\ Timestamp)>;}
\DoxyCodeLine{00022\ \textcolor{comment}{//typedef\ std::function<void(const\ TcpConnectionPtr\ \&,\ const\ std::string\ \&,\ Timestamp)>\ businessCallback;}}
\DoxyCodeLine{00023\ \textcolor{keyword}{using\ }packageFullCallback\ =\ std::function<int(std::string\_view\ view,\ std::string\ \&target)>;}
\DoxyCodeLine{00024\ }
\DoxyCodeLine{00026\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classrpc_network}{rpcNetwork}}\ :\ \textcolor{keyword}{public}\ muduo::noncopyable}
\DoxyCodeLine{00027\ \{}
\DoxyCodeLine{00028\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00029\ \ \ \ \ \mbox{\hyperlink{classrpc_network}{rpcNetwork}}(uint16\_t\ port);}
\DoxyCodeLine{00030\ \ \ \ \ \mbox{\hyperlink{classrpc_network}{\string~rpcNetwork}}();}
\DoxyCodeLine{00031\ \ \ \ \ }
\DoxyCodeLine{00033\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classrpc_network_a08268967961805817d5e344f7f944a9c}{start}}();}
\DoxyCodeLine{00034\ }
\DoxyCodeLine{00036\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classrpc_network_aacc6cb9ab518fc1c51e6042b96271ea4}{setWriteCompleteCallback}}(\textcolor{keyword}{const}\ WriteCompleteCallback\ cb)\ \{\ server.setWriteCompleteCallback(cb);\ \}}
\DoxyCodeLine{00037\ }
\DoxyCodeLine{00039\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classrpc_network_a871c221fb2493fce2e5b69855a03661f}{setConnectCallback}}(\textcolor{keyword}{const}\ ConnectionCallback\ cb)\ \{\ server.setConnectionCallback(cb);\ \}}
\DoxyCodeLine{00040\ }
\DoxyCodeLine{00042\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classrpc_network_a3a20e4312136d631231a673d3c19e1fe}{setBusinessMessageCallback}}(\textcolor{keyword}{const}\ businessCallback\ cb)\ \{\ this-\/>businessMsgCallback\ =\ cb;\ \}}
\DoxyCodeLine{00043\ }
\DoxyCodeLine{00044\ \textcolor{keyword}{private}:}
\DoxyCodeLine{00045\ \ \ \ \ \textcolor{comment}{//\ 设置验证包完整性的回调函数}}
\DoxyCodeLine{00046\ \ \ \ \ \textcolor{keywordtype}{void}\ setPackageFullCallback(\textcolor{keyword}{const}\ packageFullCallback\ cb)\ \{\ packageFull\ =\ cb;\ \};}
\DoxyCodeLine{00047\ }
\DoxyCodeLine{00048\ \ \ \ \ \textcolor{comment}{//设置连接回调函数}}
\DoxyCodeLine{00049\ \ \ \ \ \textcolor{keywordtype}{void}\ onConnectCallback(\textcolor{keyword}{const}\ TcpConnectionPtr\ \&ptr);}
\DoxyCodeLine{00050\ \ \ \ \ }
\DoxyCodeLine{00051\ \ \ \ \ \textcolor{comment}{//\ 设置workLoop数量}}
\DoxyCodeLine{00052\ \ \ \ \ \textcolor{keywordtype}{void}\ setThreadNum(\textcolor{keywordtype}{int}\ count)\{server.setThreadNum(count);\}}
\DoxyCodeLine{00053\ }
\DoxyCodeLine{00054\ \ \ \ \ \textcolor{comment}{//设置线程初始化完毕的回调函数}}
\DoxyCodeLine{00055\ \ \ \ \ \textcolor{keywordtype}{void}\ setThreadInitCallback(\textcolor{keyword}{const}\ ThreadInitCallback\ cb)\ \{\ server.setThreadInitCallback(cb);\ \}}
\DoxyCodeLine{00056\ }
\DoxyCodeLine{00057\ \ \ \ \ \textcolor{comment}{//muduo消息回调}}
\DoxyCodeLine{00058\ \ \ \ \ \textcolor{keywordtype}{void}\ onMessageCallback(\textcolor{keyword}{const}\ TcpConnectionPtr\ \&ptr,\ Buffer\ *buf,\ Timestamp);}
\DoxyCodeLine{00059\ }
\DoxyCodeLine{00060\ \ \ \ \ \textcolor{comment}{//workLoop初始化回调函数}}
\DoxyCodeLine{00061\ \ \ \ \ \textcolor{keywordtype}{void}\ onThreadInitCallback(EventLoop\ *);}
\DoxyCodeLine{00062\ }
\DoxyCodeLine{00063\ \ \ \ \ \textcolor{comment}{//\ 设置业务层的消息处理回调函数}}
\DoxyCodeLine{00064\ \ \ \ \ businessCallback\ businessMsgCallback;}
\DoxyCodeLine{00065\ }
\DoxyCodeLine{00066\ \ \ \ \ \textcolor{comment}{//设置包的完整性验证回调}}
\DoxyCodeLine{00067\ \ \ \ \ packageFullCallback\ packageFull;}
\DoxyCodeLine{00068\ }
\DoxyCodeLine{00069\ \ \ \ \ \textcolor{keyword}{const}\ std::string\ serverName\ =\ \textcolor{stringliteral}{"{}networkServer"{}};}
\DoxyCodeLine{00070\ \ \ \ \ InetAddress\ addr;}
\DoxyCodeLine{00071\ \ \ \ \ EventLoop\ loop;}
\DoxyCodeLine{00072\ \ \ \ \ TcpServer\ server;}
\DoxyCodeLine{00073\ \};}

\end{DoxyCode}
